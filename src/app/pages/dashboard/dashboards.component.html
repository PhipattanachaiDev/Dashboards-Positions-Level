<div class="modal-backdrop" *ngIf="selectedLog" (click)="closeDetail()">
  <div class="modal-content chart-modal" (click)="$event.stopPropagation()">

    <div class="modal-header">
      <h2>Organization Chart Snapshot</h2>
      <span class="close-btn" (click)="closeDetail()">&times;</span>
    </div>

    <div class="modal-body">

      <div class="chart-preview-container" *ngIf="selectedLog.graphData">

        <svg class="connections-layer">
          <path *ngFor="let conn of selectedLog.graphData.connections"
                [attr.d]="getPath(conn)"
                fill="none" stroke="#007bff" stroke-width="2" marker-end="url(#arrow)" />

          <defs>
            <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto">
              <path d="M0,0 L0,6 L9,3 z" fill="#007bff" />
            </marker>
          </defs>
        </svg>

        <div class="node-box" *ngFor="let node of selectedLog.graphData.nodes"
             [style.left.px]="node.x || node.left"
             [style.top.px]="node.y || node.top">

          <div class="node-content">
            <strong>{{ node.label || node.name }}</strong>
            <small *ngIf="node.role">{{ node.role }}</small>
          </div>

        </div>

      </div>

      <div *ngIf="!selectedLog.graphData">
         <p><strong>Details:</strong> {{ selectedLog.details }}</p>
      </div>

    </div>

    <div class="modal-footer">
      <button class="btn-close" (click)="closeDetail()">Close</button>
    </div>
  </div>
</div>
